(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function p(){return Math.random()*80-40}function L(e){const t=new THREE.PlaneGeometry(100,100),n=new THREE.MeshStandardMaterial({color:3497531}),i=new THREE.Mesh(t,n);i.rotation.x=-Math.PI/2,e.add(i);for(let o=0;o<30;o++)I(e,p(),p(),Math.random()*3+2);for(let o=0;o<15;o++)F(e,p(),p())}function I(e,t,n,i){const o=new THREE.PlaneGeometry(i,i),s=new THREE.MeshStandardMaterial({color:8190976}),a=new THREE.Mesh(o,s);a.rotation.x=-Math.PI/2,a.position.set(t,.01,n),e.add(a)}function F(e,t,n){const i=new THREE.Mesh(new THREE.BoxGeometry(.5,2,.5),new THREE.MeshStandardMaterial({color:9127187}));i.position.set(t,1,n),e.add(i);const o=new THREE.Mesh(new THREE.BoxGeometry(2,2,2),new THREE.MeshStandardMaterial({color:2263842}));o.position.set(t,3,n),e.add(o)}function W(e){const t=new THREE.Mesh(new THREE.PlaneGeometry(10,60),new THREE.MeshStandardMaterial({color:4286945}));t.rotation.x=-Math.PI/2,t.position.set(20,.05,0),e.add(t)}function B(e){const t={group:new THREE.Group,speed:.15,turnSpeed:.03,jumpForce:.3,jumping:!1,velocity:0,gravity:.01,health:100,movementState:"idle",animationSpeed:.2,armRotation:0,isSlashing:!1,slashTween:null,originalFaceRotation:0};return t.body=u(1,1.5,.5,3355647),t.body.position.y=.75,t.group.add(t.body),t.head=u(.8,.8,.8,16767916),t.head.position.y=1.8,t.group.add(t.head),D(t.head),t.arms={left:u(.25,1,.25,3355647,-.625,.75),right:u(.25,1,.25,3355647,.625,.75)},t.group.add(t.arms.left,t.arms.right),t.legs={left:u(.25,1,.25,102,-.25,-.25),right:u(.25,1,.25,102,.25,-.25)},t.group.add(t.legs.left,t.legs.right),t.group.position.y=1,e.add(t.group),P(t),b(t),t}function u(e,t,n,i,o=0,s=0,a=0){const f=new THREE.BoxGeometry(e,t,n),d=new THREE.MeshStandardMaterial({color:i}),l=new THREE.Mesh(f,d);return l.position.set(o,s,a),l}function j(e){e.movementState!=="walking"&&(e.armRotation=0,e.movementState="walking")}function P(e){e.movementState!=="idle"&&(e.armRotation=0,e.movementState="idle")}function z(e){e.jumping||(e.jumping=!0,e.velocity=e.jumpForce,e.movementState="jumping")}function N(e){if(e.isSlashing)return;e.isSlashing=!0;const n=e.head.children[0].children[2];e.originalSmileRotation=n.rotation.z,new TWEEN.Tween(n.rotation).to({z:Math.PI},300).start();const i=new TWEEN.Tween(e.arms.right.rotation).to({x:-Math.PI*.5,y:Math.PI*.25},150).easing(TWEEN.Easing.Back.Out).chain(new TWEEN.Tween(e.arms.right.rotation).to({x:-Math.PI*.25,y:-Math.PI*.5},200).easing(TWEEN.Easing.Cubic.Out).chain(new TWEEN.Tween(e.arms.right.rotation).to({x:0,y:0},300).easing(TWEEN.Easing.Quadratic.InOut).onComplete(()=>{e.isSlashing=!1,n.rotation.z=0,n.updateMatrix()}))).start();e.slashTween=i}function O(e,t){if(e.jumping&&(e.group.position.y+=e.velocity,e.velocity-=e.gravity,e.group.position.y<=1&&(e.group.position.y=1,e.jumping=!1,e.velocity=0,e.movementState==="jumping"&&(e.movementState="idle"))),!e.isSlashing)switch(e.movementState){case"walking":e.armRotation+=e.animationSpeed;const n=Math.sin(e.armRotation)*.5;e.arms.left.rotation.x=-n,e.arms.right.rotation.x=n,e.legs.left.rotation.x=n,e.legs.right.rotation.x=-n;break;case"idle":const i=Math.sin(Date.now()*.008)*.08;e.body.position.y=.75+i,e.head.position.y=1.8+i*.5,e.isSlashing||(e.arms.left.rotation.x=0,e.arms.right.rotation.x=0),e.legs.left.rotation.x=0,e.legs.right.rotation.x=0;break;case"jumping":e.arms.left.rotation.x=-.5,e.isSlashing||(e.arms.right.rotation.x=-.5);break}}function D(e){const t=new THREE.Group,n=new THREE.Mesh(new THREE.CircleGeometry(.06,16),new THREE.MeshBasicMaterial({color:0}));n.position.set(-.2,.1,.5);const i=new THREE.Mesh(new THREE.CircleGeometry(.06,16),new THREE.MeshBasicMaterial({color:0}));i.position.set(.2,.1,.5);const o=new THREE.Group,s=new THREE.BufferGeometry,f=new THREE.QuadraticBezierCurve3(new THREE.Vector3(-.2,-.1,.5),new THREE.Vector3(0,-.2,.5),new THREE.Vector3(.2,-.1,.5)).getPoints(20);s.setFromPoints(f);const d=new THREE.Line(s,new THREE.LineBasicMaterial({color:0,linewidth:3}));o.add(d),o.position.set(0,-.1,0),d.position.set(0,.1,0),t.add(n),t.add(i),t.add(o),e.add(t)}function b(e){const t=new THREE.Group,n=new THREE.Shape;n.moveTo(0,0),n.lineTo(.05,.6),n.bezierCurveTo(.1,.8,.2,.9,.3,.7),n.lineTo(.4,.3),n.lineTo(.3,0),n.lineTo(0,0);const i={steps:1,depth:.02,bevelEnabled:!0,bevelThickness:.01,bevelSize:.01,bevelSegments:1},o=new THREE.ExtrudeGeometry(n,i),s=new THREE.MeshStandardMaterial({color:2280482,metalness:.8,roughness:.2}),a=new THREE.Mesh(o,s),f=new THREE.CylinderGeometry(.03,.03,.2,8),d=new THREE.MeshStandardMaterial({color:9127187,metalness:.3,roughness:.8}),l=new THREE.Mesh(f,d);l.position.set(0,-.1,0),l.rotation.x=Math.PI/2;const A=new THREE.BoxGeometry(.15,.03,.06),C=new THREE.MeshStandardMaterial({color:16766720,metalness:.8,roughness:.2}),H=new THREE.Mesh(A,C);return H.position.set(0,0,0),t.add(a),t.add(l),t.add(H),t.rotation.z=Math.PI/6,t.rotation.y=Math.PI/2,t.position.set(.2,0,.1),t.scale.set(1.25,1.25,1.25),e.arms.right.add(t),t}window.createCharacter=B;window.startWalkingAnimation=j;window.startIdleAnimation=P;window.startJumpAnimation=z;window.updateCharacterAnimation=O;window.startSlashAnimation=N;window.createDragonScimitar=b;typeof window.keys>"u"&&(window.keys={w:!1,a:!1,s:!1,d:!1,left:!1,right:!1,space:!1,q:!1});let h=!1,M=!1,w={x:0,y:0},c=0,E=5,y=10,m=!0,g={x:0,y:0};function V(e){window.addEventListener("keydown",t=>{const n=t.key.toLowerCase();keys.hasOwnProperty(n)&&(keys[n]=!0),t.key==="ArrowLeft"&&(keys.left=!0),t.key==="ArrowRight"&&(keys.right=!0),t.key===" "&&(keys.space=!0),t.key.toLowerCase()==="q"&&!e.isSlashing&&startSlashAnimation(e)}),window.addEventListener("keyup",t=>{const n=t.key.toLowerCase();keys.hasOwnProperty(n)&&(keys[n]=!1),t.key==="ArrowLeft"&&(keys.left=!1),t.key==="ArrowRight"&&(keys.right=!1),t.key===" "&&(keys.space=!1)}),window.addEventListener("mousedown",t=>{h=!0,M=t.button===2,w.x=t.clientX,w.y=t.clientY,t.button===0&&(m=!1)}),window.addEventListener("mouseup",t=>{h=!1,t.button===0&&(m=!0)}),window.addEventListener("mousemove",t=>{h&&(g={x:t.clientX-w.x,y:t.clientY-w.y},M?(e.group.rotation.y-=g.x*.01,m=!0):(c-=g.x*.01,E=Math.max(2,Math.min(15,E+g.y*.05)),m=!1),w.x=t.clientX,w.y=t.clientY)}),window.addEventListener("contextmenu",t=>t.preventDefault())}function $(e,t){const n=new THREE.Vector3(0,0,-1).applyAxisAngle(new THREE.Vector3(0,1,0),e.group.rotation.y),i=new THREE.Vector3(1,0,0).applyAxisAngle(new THREE.Vector3(0,1,0),e.group.rotation.y),o=keys.w||keys.a||keys.s||keys.d;let s=new THREE.Vector3(0,0,0);keys.w&&s.add(n.clone().multiplyScalar(e.speed*t)),keys.s&&s.add(n.clone().negate().multiplyScalar(e.speed*t)),keys.a&&s.add(i.clone().negate().multiplyScalar(e.speed*t)),keys.d&&s.add(i.clone().multiplyScalar(e.speed*t)),e.group.position.add(s),o?e.movementState="walking":e.jumping||(e.movementState="idle");const a=e.turnSpeed*2;keys.left&&(e.group.rotation.y+=a*t),keys.right&&(e.group.rotation.y-=a*t),keys.space&&startJumpAnimation(e),m&&(o||keys.left||keys.right||M)&&q(e),updateCharacterAnimation(e,t)}function q(e){c=e.group.rotation.y,E=5,y=10}window.setupPlayerInput=V;window.updatePlayerMovement=$;window.cameraAngle=c;window.cameraHeight=E;window.cameraDistance=y;window.cameraFollow=m;typeof window.scene>"u"&&(window.scene=new THREE.Scene,scene.background=new THREE.Color(8900331));typeof window.camera>"u"&&(window.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),camera.position.set(0,5,10),camera.lookAt(0,0,0));typeof window.renderer>"u"&&(window.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!1,powerPreference:"high-performance",preserveDrawingBuffer:!0}),renderer.setSize(window.innerWidth,window.innerHeight),renderer.shadowMap.enabled=!0,document.body.appendChild(renderer.domElement));const J=new THREE.AmbientLight(4210752);scene.add(J);const R=new THREE.DirectionalLight(16777215,.8);R.position.set(10,20,10);R.castShadow=!0;scene.add(R);L(scene);W(scene);const r=createCharacter(scene);setupPlayerInput(r);function X(){const e=Math.sin(c)*y,t=Math.cos(c)*y;camera.position.set(r.group.position.x+e,r.group.position.y+E,r.group.position.z+t),camera.lookAt(r.group.position.x,r.group.position.y+1,r.group.position.z)}const Y=60,x=1e3/Y;let S=performance.now(),T=0,v=performance.now(),k=0;function G(){requestAnimationFrame(G);const e=performance.now(),t=e-S;t>=x&&(S=e-t%x,updatePlayerMovement(r,1),X(),TWEEN.update(),renderer.render(scene,camera),T++,e-v>=1e3&&(k=T,T=0,v=e,console.log(`FPS: ${k}`)))}window.addEventListener("resize",()=>{camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)});G();
