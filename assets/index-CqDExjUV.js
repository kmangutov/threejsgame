(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();function p(){return Math.random()*80-40}function C(t){const e=new THREE.PlaneGeometry(100,100),o=new THREE.MeshStandardMaterial({color:3497531}),i=new THREE.Mesh(e,o);i.rotation.x=-Math.PI/2,t.add(i);for(let n=0;n<30;n++)F(t,p(),p(),Math.random()*3+2);for(let n=0;n<15;n++)I(t,p(),p())}function F(t,e,o,i){const n=new THREE.PlaneGeometry(i,i),r=new THREE.MeshStandardMaterial({color:8190976}),s=new THREE.Mesh(n,r);s.rotation.x=-Math.PI/2,s.position.set(e,.01,o),t.add(s)}function I(t,e,o){const i=new THREE.Mesh(new THREE.BoxGeometry(.5,2,.5),new THREE.MeshStandardMaterial({color:9127187}));i.position.set(e,1,o),t.add(i);const n=new THREE.Mesh(new THREE.BoxGeometry(2,2,2),new THREE.MeshStandardMaterial({color:2263842}));n.position.set(e,3,o),t.add(n)}function j(t){const e=new THREE.Mesh(new THREE.PlaneGeometry(10,60),new THREE.MeshStandardMaterial({color:4286945}));e.rotation.x=-Math.PI/2,e.position.set(20,.05,0),t.add(e)}function B(t){const e={group:new THREE.Group,speed:.15,turnSpeed:.03,jumpForce:.3,jumping:!1,velocity:0,gravity:.01,health:100,movementState:"idle",animationSpeed:.2,armRotation:0};return e.body=l(1,1.5,.5,3355647),e.body.position.y=.75,e.group.add(e.body),e.head=l(.8,.8,.8,16767916),e.head.position.y=1.8,e.group.add(e.head),O(e.head),e.arms={left:l(.25,1,.25,3355647,-.625,.75),right:l(.25,1,.25,3355647,.625,.75)},e.group.add(e.arms.left,e.arms.right),e.legs={left:l(.25,1,.25,102,-.25,-.25),right:l(.25,1,.25,102,.25,-.25)},e.group.add(e.legs.left,e.legs.right),e.group.position.y=1,t.add(e.group),b(e),P(e),e}function l(t,e,o,i,n=0,r=0,s=0){const c=new THREE.BoxGeometry(t,e,o),y=new THREE.MeshStandardMaterial({color:i}),d=new THREE.Mesh(c,y);return d.position.set(n,r,s),d}function D(t){t.movementState!=="walking"&&(t.armRotation=0,t.movementState="walking")}function b(t){t.movementState!=="idle"&&(t.armRotation=0,t.movementState="idle")}function W(t){t.jumping||(t.jumping=!0,t.velocity=t.jumpForce,t.movementState="jumping")}function z(t,e){switch(t.jumping&&(t.group.position.y+=t.velocity,t.velocity-=t.gravity,t.group.position.y<=1&&(t.group.position.y=1,t.jumping=!1,t.velocity=0,t.movementState==="jumping"&&(t.movementState="idle"))),t.movementState){case"walking":t.armRotation+=t.animationSpeed;const o=Math.sin(t.armRotation)*.5;t.arms.left.rotation.x=-o,t.arms.right.rotation.x=o,t.legs.left.rotation.x=o,t.legs.right.rotation.x=-o;break;case"idle":const i=Math.sin(Date.now()*.008)*.08;t.body.position.y=.75+i,t.head.position.y=1.8+i*.5,t.arms.left.rotation.x=0,t.arms.right.rotation.x=0,t.legs.left.rotation.x=0,t.legs.right.rotation.x=0;break;case"jumping":t.arms.left.rotation.x=-.5,t.arms.right.rotation.x=-.5;break}}function O(t){const e=new THREE.Group,o=new THREE.Mesh(new THREE.CircleGeometry(.06,16),new THREE.MeshBasicMaterial({color:0}));o.position.set(-.2,.1,.5);const i=new THREE.Mesh(new THREE.CircleGeometry(.06,16),new THREE.MeshBasicMaterial({color:0}));i.position.set(.2,.1,.5);const n=new THREE.BufferGeometry,s=new THREE.QuadraticBezierCurve3(new THREE.Vector3(-.2,-.1,.5),new THREE.Vector3(0,-.2,.5),new THREE.Vector3(.2,-.1,.5)).getPoints(20);n.setFromPoints(s);const c=new THREE.Line(n,new THREE.LineBasicMaterial({color:0,linewidth:3}));e.add(o),e.add(i),e.add(c),t.add(e)}function P(t){const e=new THREE.Group,o=new THREE.Shape;o.moveTo(0,0),o.lineTo(.05,.6),o.bezierCurveTo(.1,.8,.2,.9,.3,.7),o.lineTo(.4,.3),o.lineTo(.3,0),o.lineTo(0,0);const i={steps:1,depth:.02,bevelEnabled:!0,bevelThickness:.01,bevelSize:.01,bevelSegments:1},n=new THREE.ExtrudeGeometry(o,i),r=new THREE.MeshStandardMaterial({color:2280482,metalness:.8,roughness:.2}),s=new THREE.Mesh(n,r),c=new THREE.CylinderGeometry(.03,.03,.2,8),y=new THREE.MeshStandardMaterial({color:9127187,metalness:.3,roughness:.8}),d=new THREE.Mesh(c,y);d.position.set(0,-.1,0),d.rotation.x=Math.PI/2;const G=new THREE.BoxGeometry(.15,.03,.06),L=new THREE.MeshStandardMaterial({color:16766720,metalness:.8,roughness:.2}),H=new THREE.Mesh(G,L);return H.position.set(0,0,0),e.add(s),e.add(d),e.add(H),e.rotation.z=Math.PI/6,e.rotation.y=Math.PI/2,e.position.set(.2,0,.1),e.scale.set(1.25,1.25,1.25),t.arms.right.add(e),e}window.createCharacter=B;window.startWalkingAnimation=D;window.startIdleAnimation=b;window.startJumpAnimation=W;window.updateCharacterAnimation=z;window.createDragonScimitar=P;typeof window.keys>"u"&&(window.keys={w:!1,a:!1,s:!1,d:!1,left:!1,right:!1,space:!1});let h=!1,M=!1,u={x:0,y:0},w=0,f=5,g=10,m=!0,E={x:0,y:0};function V(t){window.addEventListener("keydown",e=>{const o=e.key.toLowerCase();keys.hasOwnProperty(o)&&(keys[o]=!0),e.key==="ArrowLeft"&&(keys.left=!0),e.key==="ArrowRight"&&(keys.right=!0),e.key===" "&&(keys.space=!0)}),window.addEventListener("keyup",e=>{const o=e.key.toLowerCase();keys.hasOwnProperty(o)&&(keys[o]=!1),e.key==="ArrowLeft"&&(keys.left=!1),e.key==="ArrowRight"&&(keys.right=!1),e.key===" "&&(keys.space=!1)}),window.addEventListener("mousedown",e=>{h=!0,M=e.button===2,u.x=e.clientX,u.y=e.clientY,e.button===0&&(m=!1)}),window.addEventListener("mouseup",e=>{h=!1,e.button===0&&(m=!0)}),window.addEventListener("mousemove",e=>{h&&(E={x:e.clientX-u.x,y:e.clientY-u.y},M?(t.group.rotation.y-=E.x*.01,m=!0):(w-=E.x*.01,f=Math.max(2,Math.min(15,f+E.y*.05)),m=!1),u.x=e.clientX,u.y=e.clientY)}),window.addEventListener("contextmenu",e=>e.preventDefault())}function $(t,e){const o=new THREE.Vector3(0,0,-1).applyAxisAngle(new THREE.Vector3(0,1,0),t.group.rotation.y),i=new THREE.Vector3(1,0,0).applyAxisAngle(new THREE.Vector3(0,1,0),t.group.rotation.y),n=keys.w||keys.a||keys.s||keys.d;let r=new THREE.Vector3(0,0,0);keys.w&&r.add(o.clone().multiplyScalar(t.speed*e)),keys.s&&r.add(o.clone().negate().multiplyScalar(t.speed*e)),keys.a&&r.add(i.clone().negate().multiplyScalar(t.speed*e)),keys.d&&r.add(i.clone().multiplyScalar(t.speed*e)),t.group.position.add(r),n?t.movementState="walking":t.jumping||(t.movementState="idle");const s=t.turnSpeed*2;keys.left&&(t.group.rotation.y+=s*e),keys.right&&(t.group.rotation.y-=s*e),keys.space&&startJumpAnimation(t),m&&(n||keys.left||keys.right||M)&&N(t),updateCharacterAnimation(t,e)}function N(t){w=t.group.rotation.y,f=5,g=10}window.setupPlayerInput=V;window.updatePlayerMovement=$;window.cameraAngle=w;window.cameraHeight=f;window.cameraDistance=g;window.cameraFollow=m;typeof window.scene>"u"&&(window.scene=new THREE.Scene,scene.background=new THREE.Color(8900331));typeof window.camera>"u"&&(window.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),camera.position.set(0,5,10),camera.lookAt(0,0,0));typeof window.renderer>"u"&&(window.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!1,powerPreference:"high-performance",preserveDrawingBuffer:!0}),renderer.setSize(window.innerWidth,window.innerHeight),renderer.shadowMap.enabled=!0,document.body.appendChild(renderer.domElement));const J=new THREE.AmbientLight(4210752);scene.add(J);const T=new THREE.DirectionalLight(16777215,.8);T.position.set(10,20,10);T.castShadow=!0;scene.add(T);C(scene);j(scene);const a=createCharacter(scene);setupPlayerInput(a);function X(){const t=Math.sin(w)*g,e=Math.cos(w)*g;camera.position.set(a.group.position.x+t,a.group.position.y+f,a.group.position.z+e),camera.lookAt(a.group.position.x,a.group.position.y+1,a.group.position.z)}const Y=60,x=1e3/Y;let v=performance.now(),R=0,k=performance.now(),S=0;function A(){requestAnimationFrame(A);const t=performance.now(),e=t-v;e>=x&&(v=t-e%x,updatePlayerMovement(a,1),X(),TWEEN.update(),renderer.render(scene,camera),R++,t-k>=1e3&&(S=R,R=0,k=t,console.log(`FPS: ${S}`)))}window.addEventListener("resize",()=>{camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)});A();
